bazelisk readme: https://github.com/bazelbuild/bazelisk#readme
xla build from source guide: https://github.com/openxla/xla/blob/main/docs/build_from_source.md

run all commands from this directory

commands used to setup environment (will be transferred to dockerfile later):

wget https://github.com/bazelbuild/bazelisk/releases/download/v1.18.0/bazelisk-linux-amd64

chmod +x bazelisk-linux-amd64

mv bazelisk-linux-amd64 /usr/local/bin/bazel

apt-get update && apt-get install git gcc-10 g++-10 && apt-get clean \ && rm -rf /var/lib/apt/lists/*

Symlink python3 to python so bazel build can find it:
ln -s /usr/bin/python3 /usr/bin/python

git clone https://github.com/openxla/xla.git

cd xla

Interactive build configuration:
./configure
    skip Python
    no ROCm
    yes CUDA
    8.6 compute capability
    no clang
    skip gcc
    skip optimization flags

One line build configuration:
yes '' | GCC_HOST_COMPILER_PATH=/usr/bin/gcc-10 CC=/usr/bin/gcc-10 TF_NEED_ROCM=0 TF_NEED_CUDA=1 TF_CUDA_CLANG=0 ./configure

bazel build --test_output=all --spawn_strategy=sandboxed //xla/...

bazel build --sandbox_base=/dev/shm --config=monolithic

bazel build --config=cuda --sandbox_base=/dev/shm //xla/...
